/*
Copyright(c) 2012 Miracom, Inc.
*/
Ext.define("BAS.mixin.GlobalOption",function(){var i={};a();function a(){g();Ext.Ajax.request({url:"service/BasViewGlobalOptionList.json",async:false,method:"GET",params:{procstep:"1"},success:function(k,l){var j=Ext.JSON.decode(k.responseText);Ext.Array.each(j.optionList,function(m){f(m.optionName,m)})},failure:function(j,k){Ext.log("failure Global Option")},scope:this})}function d(j){return i[j]}function f(j,k){i[j]=k}function h(j){i=Ext.merge(i,j)}function e(){var j=[];for(var k in i){j.push(k)}return j}function g(){i={}}function c(j){delete i[j]}function b(){return i}return{option:{refresh:a,putAll:h,removeAll:g,remove:c,get:d,set:f,names:e,all:b}}}());Ext.define("BAS.view.common.AttributeStatusGrid",{extend:"Ext.grid.Panel",alias:["widget.bas_attrgrid","widget.bas_view_attributestatusgrid"],requires:["Ext.ux.exporter.Exporter"],exportable:true,columnLines:true,autoScroll:true,split:true,cls:"navyGrid",columns:[{xtype:"rownumberer",width:40},{header:T("Caption.Other.Name"),dataIndex:"attrName",flex:1},{header:T("Caption.Other.Description"),dataIndex:"attrDesc",flex:1},{header:T("Caption.Other.Current Value"),dataIndex:"attrValue",flex:1,renderer:function(c,b,a){if(a.get("nullFlag")=="Y"&&a.get("attrValue")==""){return"[Null]"}return c}},{type:"hidden",hidden:true,dataIndex:"longLengthAttrValueFlag"}],constructor:function(a){Ext.applyIf(this,{attrType:"",attrKey:"",attrName:"",attrFrom:0,attrTo:2147483647});BAS.view.common.AttributeStatusGrid.superclass.constructor.apply(this,arguments)},initComponent:function(){this.store=Ext.create("BAS.store.BasViewAttributeValueBriefOut.valueList",{params:{procstep:"1"}});this.buttons=[this.zdetail,this.zhistory];this.callParent();var a=this;this.on("select",function(c,b){if(b){if(b.get("longLengthAttrValueFlag")=="Y"){a.sub("btnDetail").enable()}else{a.sub("btnDetail").disable()}}});this.sub("btnDetail").on("click",function(){var c=a.getSelectionModel();var b=c.selected.getAt(0);a.onBtnDetail(b.data)});this.sub("btnHistory").on("click",function(){a.onBtnHistory()})},attrLoad:function(a){if(a){Ext.applyIf(a,{procstep:"1",attrType:this.attrType,attrKey:this.attrKey,attrFrom:this.attrFrom,attrTo:this.attrTo});this.attrType=a.attrType;this.attrKey=a.attrKey;this.store.load({params:a,callback:function(c,b,d){if(!d){return}this.lastParams=a},scope:this})}else{this.store.removeAll()}},onBtnDetail:function(a){var b=Ext.create("BAS.view.inquiry.AttributeDetail",{params:{procstep:"1",attrType:this.attrType,attrKey:this.attrKey,attrName:a.attrName}});b.show()},onBtnHistory:function(){SmartFactory.addContentView(Ext.create("BAS.view.inquiry.AttributeHistory",{opt:{procstep:"1",attrKey:this.attrKey,attrType:this.attrType}}))},zdetail:{xtype:"button",width:80,text:T("Caption.Button.Detail"),disabled:true,itemId:"btnDetail"},zhistory:{xtype:"button",width:80,text:T("Caption.Button.History"),itemId:"btnHistory"},zexport:{xtype:"exporterbutton",itemId:"btnExport",width:24}});Ext.require(["BAS.mixin.GlobalOption","BAS.view.common.AttributeStatusGrid"]);Ext.define("BAS.controller.BASController",{extend:"Ext.app.Controller",stores:[],models:[],views:["BAS.view.common.AttributeStatusGrid"],init:function(){this.control({viewport:{afterrender:this.onViewportRendered}});SmartFactory.mixin("BAS.mixin.GlobalOption")},onViewportRendered:function(){}});
